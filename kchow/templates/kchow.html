
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>KCHOW - File Transfer & Remote Execution</title>
    <link rel="icon" type="image/x-icon" href="{{ url_for('static', filename='cpfw_favicon.ico') }}">
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        function openFileDialog() {
            const input = document.createElement('input');
            input.type = 'file';
            input.webkitdirectory = true;
            input.onchange = (event) => {
                const files = event.target.files;
                if (files.length > 0) {
                    const path = files[0].webkitRelativePath.split('/')[0];
                    document.getElementById('local_path').value = path;
                }
            };
            input.click();
        }
    </script>
</head>
<body class="bg-gray-100 min-h-screen text-gray-800">
    <div class="max-w-3xl mx-auto p-6 mt-10 bg-white rounded-xl shadow-md">
        <h1 class="text-3xl font-bold text-center text-blue-700 mb-6">KCHOW - File Transfer & Remote Execution</h1>
        <form action="/execute" method="post" class="space-y-4">
            <div>
                <label for="hostnames" class="block font-semibold">Hostnames (one per line):</label>
                <textarea id="hostnames" name="hostnames" rows="5" class="w-full border rounded px-3 py-2" required></textarea>
            </div>
            <div>
                <label for="username" class="block font-semibold">Username:</label>
                <input type="text" id="username" name="username" class="w-full border rounded px-3 py-2" required>
            </div>
            <div>
                <label for="password" class="block font-semibold">Password:</label>
                <input type="password" id="password" name="password" class="w-full border rounded px-3 py-2" required>
            </div>
            <div>
                <label for="local_path" class="block font-semibold">Local Directory Path:</label>
                <div class="flex">
                    <input type="text" id="local_path" name="local_path" readonly class="w-full border rounded-l px-3 py-2">
                    <button type="button" onclick="openFileDialog()" class="bg-blue-600 text-white px-4 py-2 rounded-r hover:bg-blue-700">Select Directory</button>
                </div>
            </div>
            <div>
                <label for="remote_path" class="block font-semibold">Remote Directory Path:</label>
                <input type="text" id="remote_path" name="remote_path" class="w-full border rounded px-3 py-2">
            </div>
            <div>
                <label for="remote_script_path" class="block font-semibold">Remote Script Path:</label>
                <input type="text" id="remote_script_path" name="remote_script_path" class="w-full border rounded px-3 py-2">
            </div>
            <div class="flex items-center space-x-2">
                <input type="checkbox" id="error_checking" name="error_checking" class="form-checkbox h-5 w-5 text-blue-600">
                <label for="error_checking" class="font-semibold">Run with Error Checking</label>
            </div>
            <input type="submit" value="Execute" class="bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700 cursor-pointer w-full">
        </form>

        {% if log_content %}
        <div class="mt-10">
            <h2 class="text-2xl font-semibold text-gray-700 mb-4">Log Output:</h2>
            <div class="bg-black text-green-400 text-sm font-mono p-4 rounded overflow-y-auto max-h-96 whitespace-pre-wrap">
                {{ log_content }}
            </div>
        </div>
        {% endif %}
    </div>
</body>
</html>
